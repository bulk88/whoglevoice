<link href=https://www.googleapis.com rel=preconnect crossorigin><link href=//carrier.natasha.cat rel=preconnect><link href=https://content-people-pa.googleapis.com rel=preconnect crossorigin><link href=https://p.saproxy.us.to rel=preconnect><script src=client.js></script><meta charset=utf-8 content=0 name=mobileoptimized><style>body{margin-top:0px;}img,video{width:100%}button{line-height:1.5}p{white-space:pre-line}</style><div style=position:sticky;top:0px;background-color:white;>Welcome To Whogle Voice<button onclick=history.back()>◀Back</button><div id=sign-in-bar></div><div id=buddy-bar></div></div><div id=thread></div><script>var e;function E(v,x,T,b){var e=location.hash.substring(1);10===e.length&&(e="+1"+e),(v=v.target).textContent=" ▽⌛",getThread(e,x,function(C,f){initLnkFmt(function(){var e=document.createDocumentFragment();if(C){try{404==(f=JSON.parse(C)).error.code&&'voice_error: {"error_code":"NOT_FOUND"}'==f.error.message&&(e.textContent="Thread not found. Send the first Message.")}catch(e){alert("Error getting thread:\n\n"+C)}v.textContent=" ▽✘",T&&T(C)}else{for(var t,n,a,o,r=/(?:(?:https?|ftp):\/\/|www\.)[\w#-;!=?@\[\\\]_`{|}~]+/gi,i=lazySignedInUserIndex(),l=0;l<f.thread.item.length;l++){var s=document.createElement("p"),u=f.thread.item[l];if(u.mmsMessage&&u.mmsMessage.attachment)for(t=0;t<u.mmsMessage.attachment.length;t++)"video"==(n=u.mmsMessage.attachment[t]).mediaType?((o=s.appendChild(document.createElement("video"))).src="https://p.saproxy.us.to/u/"+i+"/a/vi/"+n.id+"?m=content",o.controls=!0,(a=s.appendChild(document.createElement("a"))).href="https://p.saproxy.us.to/u/"+i+"/a/vi/"+n.id+"?m=content",a.textContent="Download Video"):"audio"==n.mediaType?((o=s.appendChild(document.createElement("audio"))).src="https://p.saproxy.us.to/u/"+i+"/a/au/"+n.id+"?m=content",o.controls=!0,(a=s.appendChild(document.createElement("a"))).href="https://p.saproxy.us.to/u/"+i+"/a/au/"+n.id+"?m=content",a.textContent="Download Audio"):"vcard"==n.mediaType?((o=s.appendChild(document.createElement("img"))).isvcard=1,o.src="https://p.saproxy.us.to/u/"+i+"/a/vc/"+n.id,(a=s.appendChild(document.createElement("a"))).href="https://p.saproxy.us.to/u/"+i+"/a/vc/"+n.id,a.textContent="Download Vcard"):(o=document.createElement("img"),b&&(o.onload=b),o.src="https://p.saproxy.us.to/u/"+i+"/a/i/"+n.id+"?s=2",(a=document.createElement("a")).href="https://p.saproxy.us.to/u/"+i+"/a/i/"+n.id+"?s=4",a.onclick=h,a.appendChild(o),s.appendChild(a)),o.onerror=m,a.target="_blank";for(e.insertBefore(s,e.firstChild),u.isArtificialErrorMessage?s.style.backgroundColor="red":s.style.outline="1px solid black",s.align="smsIn"==u.type?"left":"right",a=(o=new Date(Number(u.startTime))).toDateString(),s.appendChild(document.createTextNode(a.slice(0,12)+a.slice(14)+" "+o.toLocaleTimeString()+"- ")),t=0,o=u.mmsMessage?u.mmsMessage.text:u.messageText;a=r.exec(o);)a.index-t&&s.appendChild(document.createTextNode(o.substring(t,a.index))),s.appendChild(wvLinkFmt(a[0])),t=r.lastIndex;t!=o.length&&s.appendChild(document.createTextNode(o.slice(t))),0==l&&(s.mid=u.id),v.textContent=" ▽✔"}""===(a=document.getElementById("buddy-bar").firstChild.firstChild).nodeValue&&(a.nodeValue=f.thread.contact.reduce(function(e,t){return"Unknown"!=t.phoneNumber?t:e}).name+"-"),(o=f.thread.paginationToken)&&((s=e.insertBefore(document.createElement("button"),e.firstChild)).textContent=" Load More ",s.wvpgtok=o,s.onclick=function(e){E(e,e.target.wvpgtok)})}if(e.childNodes.length){var p=document.getElementById("thread");if(x)p.replaceChild(e,p.firstChild);else{for(;p.lastChild;)p.removeChild(p.lastChild);p.appendChild(e)}(p=document.forms.folderForm.folder).curValue=p.value=f.thread.view[0]}T&&T(!1,f)})})}function v(e){(e=document.scrollingElement||document.body).scrollTop=e.scrollHeight}initLnkFmt();var t,n=[2e3,2e3,2e3,2500,2500,2500,2500,2500],a=0,o=0;function x(e){o++<14&&(e=e||(a<n.length?n[a++]:6e3),t=setTimeout(function(){var e=location.hash.substring(1);10===e.length&&(e="+1"+e),chkNewMsg(e,function(e,t){var n=document.getElementById("thread");(n=n&&n.lastChild)?(e=t.indexOf('[["',3)+3,t.slice(e,t.indexOf('"',e))!=n.mid?E({target:{textContent:0}},0,r):x()):r()})},e))}function r(){clearTimeout(t),o=a=0,x()}function T(e){localStorage.setItem("wvCallDir",e.target.value)}function i(){for(var n,a,e,t,o,r,i,l,s=location.hash,u=document.getElementById("buddy-bar");u.lastChild;)u.removeChild(u.lastChild);if(""!=s&&"#"!=s){s=s.substring(1),E({target:{textContent:0}},0,function(){v(),x(6e3)},v);var m,p=document.createDocumentFragment(),h=document.createTextNode(""),C=(n=p.appendChild(document.createElement("span")),a=h,e=s,getContactName(e,function(e,t){t&&(n.setAttribute("data-pid",t[1]),(e=t[2])&&n.setAttribute("data-url",e),(n=n.firstChild).nodeValue!=(e=t[0])&&(n.nodeValue=e),e=t[3])&&a.nodeValue!=(e+="-")&&(a.nodeValue=e)}),e='<a href="thread.html#'+e+'"',i="",(l=localStorage.getItem(sessionStorage.getItem("wvArchView")?"wvThdListA":"wvThdListM"))&&-1!=(o=l.indexOf(e))&&-1!=(r=l.indexOf(">",o))&&(-1!=(e=l.indexOf('data-lec="',o))&&e<r&&-1!=(t=l.indexOf('"',e+=10))&&(a.nodeValue=l.substring(e,t)+"-"),-1!=(e=l.indexOf('data-pid="',o))&&e<r&&-1!=(t=l.indexOf('"',e+=10))&&n.setAttribute("data-pid",l.substring(e,t)),-1!=(e=l.indexOf("<",r)))&&(e=l.substring(r+1,e))&&(i=e),n.appendChild(document.createTextNode(i)),p.appendChild(document.createElement("button"))),d=(C.textContent="✏️",C.onclick=function(e){var o=this.onclick,r=this.previousElementSibling,t=document.createElement("input"),i=t.value=r.textContent;t.setAttribute("data-pid",r.getAttribute("data-pid")),this.onclick=function(){function e(e,t){e?n.textContent="✏️✘":(r.textContent=(t=t.personResponse.person).name[0].displayName,t.website&&r.setAttribute("data-url",t.website[0].value),n.textContent="✏️✔",t=document.forms.folderForm.folder.value,localStorage.removeItem("allThreads"==t?"wvThdListM":"allArchivedThreads"==t?"wvThdListA":alert(0))),n.onclick=o,n.parentNode.replaceChild(r,a)}var t,n=this,a=n.previousElementSibling;i!==a.value?(n.textContent="✏️⌛","null"!==(t=a.getAttribute("data-pid"))?upContact(t,a.value,null,null,e):mkContact(a.value,location.hash.substring(1),e)):(n.parentNode.replaceChild(r,a),n.onclick=o)},this.parentNode.replaceChild(t,r),t.focus()},10===s.length&&((carrierUpdate=function(e){var t=1,n=(e+="-").match(/(CINGULAR)|(CELLCO PARTNERSHIP)|(OMNIPOINT|T-MOBILE USA|METROPCS)|(BANDWIDTH.COM)|(SPRINT SPECTRUM)|(Inteliquent)|(PEERLESS NETWORK OF NEW YORK)/);if(n)for(;t<8;t++)if(n[t]){e=[,"ATTW-","VZW-","TM-","BCOM-","SPCS-","ITQL-","PLSNY-"][t];break}(t=carrierUpdate.wvnode).nodeValue!=e&&(t.nodeValue=e,n=t.parentElement.parentElement.firstChild.getAttribute("data-pid"))&&upContact(n,null,null,e.slice(0,-1),function(e){e||(e=document.forms.folderForm.folder.value,localStorage.removeItem("allThreads"==e?"wvThdListM":"allArchivedThreads"==e?"wvThdListA":alert(0)))}),carrierUpdate=null}).wvnode=p.appendChild(document.createElement("span")).appendChild(h),(C=document.createElement("script")).src="//carrier.natasha.cat/"+s.substring(0,7),p.appendChild(C)),(C=document.createElement("a")).textContent=s,C.href="https://www.telcodata.us/search-area-code-exchange-detail?npa="+s.substr(0,3)+"&exchange="+s.substr(3,3),p.appendChild(C),0|localStorage.getItem("wvCallDir")),f=[" In","Out On","Out Off"];for(m in f)m|=0,(C=p.appendChild(document.createElement("label"))).textContent=f[m],(C=C.appendChild(document.createElement("input"))).type="radio",C.name="d",C.value=m,C.onchange=T,C.checked=d==m;(C=p.appendChild(document.createElement("button"))).wvnum=s,C.textContent="ㅤCall ㅤ",C.onclick=function(t){(t=t.target).textContent="ㅤCalling⌛ㅤ",mkCall(t,t.wvnum,0|localStorage.getItem("wvCallDir"),function(e){t.textContent=e?"ㅤCalled ✘ㅤ":"ㅤCalled ✔ㅤ"})},(C=p.appendChild(document.createElement("button"))).textContent=" Bottom⬇ ",C.onclick=v,u.appendChild(p)}else u.appendChild(document.createElement("span")),u.appendChild(document.createElement("span")).textContent="no num specified in url anchor"}(onhashchange=i)();var refreshNoUI=i;drawLoginBar(),window.ononline=function(){14<=o&&(o=13),x(1)}</script><textarea id=msg placeholder="Type outgoing msg here"style=width:100%></textarea><br><button onclick=history.back()>◀Back</button> <button onclick=f(event)> ✉    </button> <button onclick=f(event,0,function(n){n||history.back()})>✉◀   </button> <button onclick=window.scrollTo(0,0)>ㅤ⬆Topㅤ</button> <button onclick='document.getElementById("msg").value=""'> ✖ </button> <button onclick=E(event) id=rfsh style=width:3.5em;text-align:left;> ▽ </button><br><form name=folderForm style=display:inline><label><input onchange="return p(this)"type=radio name=folder value=allThreads>Mn</label> <label><input onchange="return p(this)"type=radio name=folder value=allArchivedThreads>Ar</label> <label><input onchange="return p(this)"type=radio name=folder value=allSpamThreads>Sm</label><span id=folderChg style=display:inline-block;width:1em>ㅤ</span></form><label for=ipk>Choose attachment:</label> <button onclick=u()>Clear Img</button> <input onchange=l(event) type=file accept=image/* id=ipk><br><img id=prv><script>var l=function(e){var t=new FileReader;t.onload=function(){document.getElementById("prv").src=t.result},t.readAsDataURL(e.target.files[0])};function u(){document.getElementById("ipk").value=null;var e=document.getElementById("prv"),t=e.nextSibling,n=e.parentNode;n.removeChild(e).removeAttribute("src"),n.insertBefore(e.cloneNode(),t)}function f(o,e,a){var l,i=document.getElementById("prv").src,s=document.getElementById("msg");0!=s.value.length||i||e?(clearTimeout(t),o=o.target.firstChild,"no num specified in url anchor"==(l=location.hash.substring(1))&&(l=""),i&&(i=-1==(e=i.indexOf(","))?(alert("Image selected could not be turned into a DATA URL"),""):i.substr(e+1)),o.nodeValue=o.nodeValue.slice(0,2)+"⌛ ",sendsms(l,s.value,i,function(e,t){var n;e?(o.nodeValue=o.nodeValue.slice(0,2)+"✘ ",x()):(n=t[2],o.nodeValue=o.nodeValue.slice(0,2)+"✔ ",E({target:{textContent:0}},0,function(e,t){e||(t.thread.item[0].id!=n?(alert("Warning: sent outgoing message , server confirmed, but not in chat log"),sendsms(l,s.value,i,function(e,t){e||r()})):(s.value="",u(),r()))})),a&&a(e)})):(e=navigator.clipboard)&&e.readText&&e.readText().then(function(e){0==(s.value=e).length&&f(o,1,a)})}function s(n){n.preventDefault(),n=n.currentTarget,attachIDtoB64(n.wv_id,1,0,function(e,t){e||(n.onclick=void 0,n.href="data:image/jpeg;base64,"+t,n.firstChild.src=n.href)})}function h(e){e.preventDefault(),e.target.src=e.currentTarget.href,e.currentTarget.onclick=void 0}function m(n){(n=n.target).onerror=void 0;var o=n.isvcard||"VIDEO"==n.nodeName,a="AUDIO"==n.nodeName,r=o||a?n.src:(n=n.parentNode).href,t=r.lastIndexOf("?");-1==t&&(t=void 0),r=r.substring(r.lastIndexOf("/")+1,t),attachIDtoB64(r,o||a?4:2,o?1:a?2:0,function(e,t){e||(a?(n.src=t="data:audio/mp3;base64,"+t,n.nextElementSibling.href=t):o?(t="data:"+(n.isvcard?"text/x-vcard":"video/mp4")+";base64,"+t,"VIDEO"==n.nodeName&&(n.src=t),n.nextElementSibling.href=t):(n.wv_id=r,n.onclick=s,n.firstChild.src="data:image/jpeg;base64,"+t,"addEventHandler"in n.firstChild||setTimeout(v,100)))}),e||((t=document.createElement("div")).style.color="red",t.textContent="Using the alternate slow image loader.",document.body.insertBefore(t,document.getElementById("msg")),e=1)}function p(e){function t(e,t){t=e?(alert("Error moving thread thread:\n\n"+e),e="✘",a.curValue):(e="✔",t.attributes.view[0]),n.textContent=e,a.curValue=a.value=t}var n=e.parentNode.parentNode.lastChild,o=location.hash.substring(1),a=e.parentNode.parentNode.folder;switch(n.textContent="⌛",e.value){case"allThreads":b(o,0,0,null,0,t);break;case"allArchivedThreads":b(o,0,0,null,1,t);break;case"allSpamThreads":b(o,0,1,null,0,t);break;default:throw 0}localStorage.removeItem("wvThdListM"),localStorage.removeItem("wvThdListA")}function b(t,n,o,a,r,l){getAuthToken(function(e){w(!0,e,t,n,o,a,r,l)})}function w(e,t,n,o,a,r,l,i){function s(e,t,n){null!=t&&(e[0][n]=t?1:0,e[1][n]=1)}var u=new XMLHttpRequest,f=[["t.+1"+n],[],1];s(f,o,1),s(f,a,2),s(f,r,3),s(f,l,5),u.open("POST","https://www.googleapis.com/voice/v1/voiceclient/thread/updateattributes?alt=json&prettyPrint=false",1),u.setRequestHeader("Content-Type","application/json+protobuf"),u.setRequestHeader("Authorization","Bearer "+t),u.onreadystatechange=function(){4==u.readyState&&(e&&401==u.status&&resp401Unauth(u.response)?(wvWipeAuthToken(),getAuthToken(function(e){w(!1,e,n,o,a,r,l,i)})):200!=u.status?(404!=u.status&&alert("status: "+u.status+"\nresp:"+u.response),i&&i(u.response||-1)):i&&i(!1,JSON.parse(u.response)))},u.send(JSON.stringify(f))}!function(){function e(e){e.style.height="auto",e.style.overflow="hidden",e.style.height=e.scrollHeight+e.offset+"px",e.style.overflow=""}var t=document.getElementById("msg");t.offset=window.opera?t.offsetHeight+parseInt(window.getComputedStyle(t,null).getPropertyValue("border-top-width")):t.offsetHeight-t.clientHeight,e(t),t.oninput=function(){e(t)},t.onmouseup=function(){e(t)}}()</script>